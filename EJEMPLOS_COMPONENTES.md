# üîß Ejemplos Pr√°cticos de Actualizaci√≥n de Componentes\n\n## Introducci√≥n\n\nEste documento muestra c√≥mo actualizar componentes existentes en tu proyecto para usar las APIs del Backend en lugar de localStorage.\n\nCada ejemplo incluye:\n- **C√≥digo ANTES** (localStorage)\n- **C√≥digo DESPU√âS** (Backend API)\n- **Explicaci√≥n de cambios**\n\n---\n\n## üì¶ Ejemplo 1: Componente Simple de Listado\n\n### ‚ùå ANTES (localStorage)\n\n```javascript\n// Front/src/components/Productos/TablaProductos.js\nimport React, { useState, useEffect } from 'react';\nimport { getProductosLocal } from '../../services/productsService';\n\nexport default function TablaProductos() {\n    const [productos, setProductos] = useState([]);\n\n    useEffect(() => {\n        // Cargar de localStorage\n        const lista = getProductosLocal();\n        setProductos(lista);\n    }, []);\n\n    return (\n        <table>\n            <tbody>\n                {productos.map(p => (\n                    <tr key={p.id}>\n                        <td>{p.nombre}</td>\n                        <td>${p.precio}</td>\n                    </tr>\n                ))}\n            </tbody>\n        </table>\n    );\n}\n```\n\n### ‚úÖ DESPU√âS (Backend API)\n\n```javascript\n// Front/src/components/Productos/TablaProductos.js\nimport React, { useState, useEffect } from 'react';\nimport { getProductos } from '../../services/productsService';\n\nexport default function TablaProductos() {\n    const [productos, setProductos] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    useEffect(() => {\n        const cargarProductos = async () => {\n            try {\n                const data = await getProductos();\n                setProductos(data);\n            } catch (err) {\n                setError(err.message);\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        cargarProductos();\n    }, []);\n\n    if (loading) return <div>Cargando...</div>;\n    if (error) return <div>Error: {error}</div>;\n\n    return (\n        <table>\n            <tbody>\n                {productos.map(p => (\n                    <tr key={p.id}>\n                        <td>{p.nombre}</td>\n                        <td>${p.precio}</td>\n                    </tr>\n                ))}\n            </tbody>\n        </table>\n    );\n}\n```\n\n### üìù Cambios realizados:\n1. Cambi√© `getProductosLocal()` por `await getProductos()`\n2. Agregu√© `async` en la funci√≥n dentro de useEffect\n3. Agregu√© estados para `loading` y `error`\n4. Agregu√© manejo de errores con try/catch\n5. Agregu√© condicionales para mostrar estados\n\n---\n\n## üìù Ejemplo 2: Formulario de Creaci√≥n\n\n### ‚ùå ANTES (localStorage)\n\n```javascript\n// Front/src/components/Productos/FormProducto.js\nimport React, { useState } from 'react';\nimport { createProductoLocal } from '../../services/productsService';\n\nexport default function FormProducto() {\n    const [form, setForm] = useState({ nombre: '', precio: 0 });\n\n    const handleSubmit = (e) => {\n        e.preventDefault();\n        createProductoLocal(form);\n        setForm({ nombre: '', precio: 0 });\n        alert('Producto creado');\n    };\n\n    return (\n        <form onSubmit={handleSubmit}>\n            <input\n                value={form.nombre}\n                onChange={(e) => setForm({ ...form, nombre: e.target.value })}\n            />\n            <input\n                type=\"number\"\n                value={form.precio}\n                onChange={(e) => setForm({ ...form, precio: e.target.value })}\n            />\n            <button type=\"submit\">Crear</button>\n        </form>\n    );\n}\n```\n\n### ‚úÖ DESPU√âS (Backend API)\n\n```javascript\n// Front/src/components/Productos/FormProducto.js\nimport React, { useState } from 'react';\nimport { createProducto } from '../../services/productsService';\n\nexport default function FormProducto({ onSuccess }) {\n    const [form, setForm] = useState({ nombre: '', precio: 0, descripcion: '', stock: 0 });\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState(null);\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        try {\n            setLoading(true);\n            setError(null);\n            await createProducto(form);\n            setForm({ nombre: '', precio: 0, descripcion: '', stock: 0 });\n            onSuccess?.();\n            alert('Producto creado exitosamente');\n        } catch (err) {\n            setError(err.message);\n            alert(`Error: ${err.message}`);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <form onSubmit={handleSubmit}>\n            <input\n                value={form.nombre}\n                onChange={(e) => setForm({ ...form, nombre: e.target.value })}\n                placeholder=\"Nombre\"\n                required\n            />\n            <input\n                type=\"number\"\n                value={form.precio}\n                onChange={(e) => setForm({ ...form, precio: parseFloat(e.target.value) })}\n                placeholder=\"Precio\"\n                required\n            />\n            <input\n                value={form.descripcion}\n                onChange={(e) => setForm({ ...form, descripcion: e.target.value })}\n                placeholder=\"Descripci√≥n\"\n            />\n            <input\n                type=\"number\"\n                value={form.stock}\n                onChange={(e) => setForm({ ...form, stock: parseInt(e.target.value) })}\n                placeholder=\"Stock\"\n                required\n            />\n            <button type=\"submit\" disabled={loading}>\n                {loading ? 'Guardando...' : 'Crear'}\n            </button>\n            {error && <p style={{ color: 'red' }}>{error}</p>}\n        </form>\n    );\n}\n```\n\n### üìù Cambios realizados:\n1. Cambi√© `createProductoLocal()` por `await createProducto()`\n2. Agregu√© `async` en handleSubmit\n3. Agregu√© estado `loading` para deshabilitar bot√≥n mientras se guarda\n4. Agregu√© estado `error` para mostrar mensajes\n5. Agregu√© callback `onSuccess` para avisar al componente padre\n6. Agregu√© campos adicionales (`descripcion`, `stock`)\n7. Agregu√© validaciones con `required`\n\n---\n\n## ‚úèÔ∏è Ejemplo 3: Componente con Editar y Eliminar\n\n### ‚ùå ANTES (localStorage)\n\n```javascript\n// Parcial - solo la parte que cambi√≥\nimport { updateProductoLocal, deleteProductoLocal } from '../../services/productsService';\n\nfunction ProductoRow({ producto }) {\n    const handleEdit = (newData) => {\n        updateProductoLocal(producto.id, newData);\n        alert('Actualizado');\n    };\n\n    const handleDelete = () => {\n        deleteProductoLocal(producto.id);\n        alert('Eliminado');\n    };\n\n    return (\n        <tr>\n            <td>{producto.nombre}</td>\n            <td>\n                <button onClick={() => handleEdit({ nombre: 'Nuevo nombre' })}>\n                    Editar\n                </button>\n                <button onClick={handleDelete}>Eliminar</button>\n            </td>\n        </tr>\n    );\n}\n```\n\n### ‚úÖ DESPU√âS (Backend API)\n\n```javascript\n// Parcial - solo la parte que cambi√≥\nimport { updateProducto, deleteProducto } from '../../services/productsService';\n\nfunction ProductoRow({ producto, onUpdate, onDelete }) {\n    const [updating, setUpdating] = React.useState(false);\n    const [deleting, setDeleting] = React.useState(false);\n\n    const handleEdit = async (newData) => {\n        try {\n            setUpdating(true);\n            await updateProducto(producto.id, newData);\n            alert('Actualizado');\n            onUpdate?.();\n        } catch (err) {\n            alert(`Error: ${err.message}`);\n        } finally {\n            setUpdating(false);\n        }\n    };\n\n    const handleDelete = async () => {\n        if (!window.confirm('¬øEst√° seguro?')) return;\n        try {\n            setDeleting(true);\n            await deleteProducto(producto.id);\n            alert('Eliminado');\n            onDelete?.();\n        } catch (err) {\n            alert(`Error: ${err.message}`);\n        } finally {\n            setDeleting(false);\n        }\n    };\n\n    return (\n        <tr>\n            <td>{producto.nombre}</td>\n            <td>\n                <button \n                    onClick={() => handleEdit({ nombre: 'Nuevo nombre' })}\n                    disabled={updating || deleting}\n                >\n                    {updating ? 'Actualizando...' : 'Editar'}\n                </button>\n                <button \n                    onClick={handleDelete}\n                    disabled={updating || deleting}\n                >\n                    {deleting ? 'Eliminando...' : 'Eliminar'}\n                </button>\n            </td>\n        </tr>\n    );\n}\n```\n\n### üìù Cambios realizados:\n1. Cambi√© de funciones s√≠ncronas a `async`\n2. Agregu√© `await` en actualizar y eliminar\n3. Agregu√© estados `updating` y `deleting`\n4. Agregu√© confirmaci√≥n antes de eliminar\n5. Agregu√© deshabilitaci√≥n de botones mientras se procesa\n6. Agregu√© callbacks para avisar al padre que refresque\n\n---\n\n## üèóÔ∏è Ejemplo 4: Componente Complejo (CRUD Completo)\n\n### ‚úÖ DESPU√âS (Backend API)\n\n```javascript\n// Front/src/pages/admin/productos-crud/index.js\nimport React, { useState, useEffect } from 'react';\nimport { \n    getProductos, \n    getProductoById,\n    createProducto, \n    updateProducto, \n    deleteProducto \n} from '../../../services/productsService';\n\nexport default function ProductosCRUD() {\n    const [productos, setProductos] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n    const [showForm, setShowForm] = useState(false);\n    const [editingId, setEditingId] = useState(null);\n    const [form, setForm] = useState({\n        nombre: '',\n        descripcion: '',\n        precio: 0,\n        stock: 0\n    });\n\n    // Cargar productos al montar\n    useEffect(() => {\n        cargarProductos();\n    }, []);\n\n    const cargarProductos = async () => {\n        try {\n            setLoading(true);\n            const data = await getProductos();\n            setProductos(data);\n        } catch (err) {\n            setError(err.message);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleChange = (e) => {\n        const { name, value } = e.target;\n        setForm(prev => ({\n            ...prev,\n            [name]: ['precio', 'stock'].includes(name) ? parseFloat(value) : value\n        }));\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        try {\n            if (editingId) {\n                await updateProducto(editingId, form);\n            } else {\n                await createProducto(form);\n            }\n            cargarProductos();\n            resetForm();\n        } catch (err) {\n            alert(`Error: ${err.message}`);\n        }\n    };\n\n    const handleEdit = async (id) => {\n        try {\n            const producto = await getProductoById(id);\n            setForm(producto);\n            setEditingId(id);\n            setShowForm(true);\n        } catch (err) {\n            alert(`Error al cargar: ${err.message}`);\n        }\n    };\n\n    const handleDelete = async (id) => {\n        if (!window.confirm('¬øEliminar este producto?')) return;\n        try {\n            await deleteProducto(id);\n            cargarProductos();\n        } catch (err) {\n            alert(`Error: ${err.message}`);\n        }\n    };\n\n    const resetForm = () => {\n        setForm({ nombre: '', descripcion: '', precio: 0, stock: 0 });\n        setEditingId(null);\n        setShowForm(false);\n    };\n\n    if (loading) return <div>Cargando...</div>;\n    if (error) return <div className=\"alert alert-danger\">Error: {error}</div>;\n\n    return (\n        <div className=\"container\">\n            <h1>Gesti√≥n de Productos</h1>\n\n            {!showForm && (\n                <button \n                    className=\"btn btn-primary mb-3\"\n                    onClick={() => setShowForm(true)}\n                >\n                    + Nuevo Producto\n                </button>\n            )}\n\n            {showForm && (\n                <form onSubmit={handleSubmit} className=\"card p-4 mb-4\">\n                    <h3>{editingId ? 'Editar' : 'Crear'} Producto</h3>\n\n                    <input\n                        type=\"text\"\n                        name=\"nombre\"\n                        placeholder=\"Nombre\"\n                        value={form.nombre}\n                        onChange={handleChange}\n                        className=\"form-control mb-2\"\n                        required\n                    />\n\n                    <textarea\n                        name=\"descripcion\"\n                        placeholder=\"Descripci√≥n\"\n                        value={form.descripcion}\n                        onChange={handleChange}\n                        className=\"form-control mb-2\"\n                    />\n\n                    <input\n                        type=\"number\"\n                        name=\"precio\"\n                        placeholder=\"Precio\"\n                        value={form.precio}\n                        onChange={handleChange}\n                        className=\"form-control mb-2\"\n                        step=\"0.01\"\n                        required\n                    />\n\n                    <input\n                        type=\"number\"\n                        name=\"stock\"\n                        placeholder=\"Stock\"\n                        value={form.stock}\n                        onChange={handleChange}\n                        className=\"form-control mb-2\"\n                        required\n                    />\n\n                    <div>\n                        <button type=\"submit\" className=\"btn btn-success\">\n                            Guardar\n                        </button>\n                        <button \n                            type=\"button\" \n                            className=\"btn btn-secondary ms-2\"\n                            onClick={resetForm}\n                        >\n                            Cancelar\n                        </button>\n                    </div>\n                </form>\n            )}\n\n            <table className=\"table\">\n                <thead>\n                    <tr>\n                        <th>ID</th>\n                        <th>Nombre</th>\n                        <th>Precio</th>\n                        <th>Stock</th>\n                        <th>Acciones</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {productos.map(p => (\n                        <tr key={p.id}>\n                            <td>{p.id}</td>\n                            <td>{p.nombre}</td>\n                            <td>${p.precio}</td>\n                            <td>{p.stock}</td>\n                            <td>\n                                <button\n                                    className=\"btn btn-sm btn-warning me-2\"\n                                    onClick={() => handleEdit(p.id)}\n                                >\n                                    Editar\n                                </button>\n                                <button\n                                    className=\"btn btn-sm btn-danger\"\n                                    onClick={() => handleDelete(p.id)}\n                                >\n                                    Eliminar\n                                </button>\n                            </td>\n                        </tr>\n                    ))}\n                </tbody>\n            </table>\n        </div>\n    );\n}\n```\n\n---\n\n## üìã Patr√≥n General para Actualizar Componentes\n\n```javascript\n// PATR√ìN EST√ÅNDAR\n\n1. Importar servicio correcto:\n   import { getProductos, createProducto } from '../services/productsService';\n\n2. Definir estados:\n   const [data, setData] = useState([]);\n   const [loading, setLoading] = useState(true);\n   const [error, setError] = useState(null);\n\n3. useEffect para cargar datos:\n   useEffect(() => {\n       const fetch = async () => {\n           try {\n               const result = await getProductos();\n               setData(result);\n           } catch (err) {\n               setError(err.message);\n           } finally {\n               setLoading(false);\n           }\n       };\n       fetch();\n   }, []);\n\n4. Mostrar estados:\n   if (loading) return <div>Cargando...</div>;\n   if (error) return <div>Error: {error}</div>;\n\n5. Usar async/await en handlers:\n   const handleCreate = async (data) => {\n       try {\n           await createProducto(data);\n           // Refresh list\n       } catch (err) {\n           // Handle error\n       }\n   };\n```\n\n---\n\n## üîÑ Componentes del Proyecto a Actualizar\n\nEstos son los principales que necesitan actualizaci√≥n:\n\n| Componente | Ubicaci√≥n | Cambio |\\n| --- | --- | --- |\\n| TablaProductos | `components/Productos/TablaProductos.js` | localStorage ‚Üí getProductos() |\\n| FormProducto | `components/Productos/FormProducto.js` | createProductoLocal ‚Üí createProducto() |\\n| ServicioCard | `components/Servicios/ServicioCard.js` | servicesService.getServices() ‚Üí getServicios() |\\n| CartFloating | `components/Compras/CartFloating.js` | Mantener contexto, pero usar APIs |\\n| CartSidebar | `components/Compras/CartSidebar.js` | Actualizar para usar APIs |\\n| Navbar components | `components/Navbar/*.js` | Usar usuariosService.getUsuarios() |\\n| Admin pages | `pages/admin/**` | Todas necesitan actualizar a APIs |\\n| Cliente pages | `pages/cliente/**` | Usar APIs correspondientes |\\n\n---\n\n## ‚úÖ Checklist para cada actualizaci√≥n\n\n```\n‚òê Elimin√© importes de funciones locales (Local)\n‚òê Import√© funciones del servicio correcto\n‚òê Agregu√© async/await en funciones que lo necesitan\n‚òê Agregu√© estados loading, error\n‚òê Agregu√© useEffect si cargar datos al montar\n‚òê Agregu√© try/catch en operaciones async\n‚òê Mostr√© UI diferente seg√∫n loading/error/success\n‚òê Prob√© que funciona en DevTools (Network tab)\n‚òê Verificado que no tiene errores en console\n‚òê Confirm√© que los datos vienen del Backend\n```\n\n---\n\n## üéØ Orden Recomendado de Actualizaci√≥n\n\n1. **Componentes de lectura** (listar datos) - m√°s f√°cil\n2. **Componentes de creaci√≥n** (formularios)\n3. **Componentes de edici√≥n** (update)\n4. **Componentes de eliminaci√≥n** (delete)\n5. **P√°gina de admin** (CRUD completo)\n6. **P√°gina de cliente** (funcionalidades espec√≠ficas)\n7. **Contexto y hooks** (estado global)\n\n---\n\nüí° **Consejo:** Actualiza un componente a la vez, prueba que funcione, luego contin√∫a al siguiente.\n"